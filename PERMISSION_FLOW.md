# ðŸ” Permission Request Flow

## User Journey

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     APP LAUNCH                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ENHANCED LOADING SCREEN                        â”‚
â”‚                                                             â”‚
â”‚                    BOUNTU (Glowing)                         â”‚
â”‚                  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘                           â”‚
â”‚                       75%                                   â”‚
â”‚                                                             â”‚
â”‚              made by SN-Mrdatobg                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                   (Check Permissions)
                            â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ All Granted?  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†™           â†˜
                   YES              NO
                    â†“                â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   MAIN SCREEN    â”‚   â”‚  PERMISSION SCREEN   â”‚
        â”‚                  â”‚   â”‚                      â”‚
        â”‚  Terminal        â”‚   â”‚  ðŸ”’ Lock Icon        â”‚
        â”‚  Themes          â”‚   â”‚                      â”‚
        â”‚  Security        â”‚   â”‚  Permissions Needed  â”‚
        â”‚  Connection      â”‚   â”‚                      â”‚
        â”‚  Packages        â”‚   â”‚  âœ“ Internet          â”‚
        â”‚                  â”‚   â”‚  âœ“ Network State     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  âœ“ Notifications     â”‚
                               â”‚                      â”‚
                               â”‚  [Grant Permissions] â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â†“
                               (User Clicks Button)
                                        â†“
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  SYSTEM PERMISSION       â”‚
                          â”‚  DIALOG (Android)        â”‚
                          â”‚                          â”‚
                          â”‚  Allow Bountu to:        â”‚
                          â”‚  â€¢ Access Internet       â”‚
                          â”‚  â€¢ Check Network         â”‚
                          â”‚  â€¢ Send Notifications    â”‚
                          â”‚                          â”‚
                          â”‚  [Allow]  [Deny]         â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†™        â†˜
                              ALLOW          DENY
                                â†“             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   MAIN SCREEN    â”‚  â”‚  WARNING DIALOG  â”‚
                    â”‚   (Full Access)  â”‚  â”‚                  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  Some permissionsâ”‚
                                          â”‚  were denied.    â”‚
                                          â”‚  App may not     â”‚
                                          â”‚  function fully. â”‚
                                          â”‚                  â”‚
                                          â”‚      [OK]        â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â†“
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚ PERMISSION SCREENâ”‚
                                          â”‚ (Try Again)      â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Permission Screen Details

### Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚              ðŸ”’ (64dp Icon)             â”‚
â”‚                                         â”‚
â”‚        Permissions Required             â”‚
â”‚                                         â”‚
â”‚  Bountu needs the following            â”‚
â”‚  permissions to function properly:      â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âœ“ Internet                        â”‚ â”‚
â”‚  â”‚   Required for communication      â”‚ â”‚
â”‚  â”‚   with Windows                    â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ âœ“ Network State                   â”‚ â”‚
â”‚  â”‚   Check network connectivity      â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ âœ“ Notifications (Android 13+)     â”‚ â”‚
â”‚  â”‚   Show important alerts           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      Grant Permissions            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Permission States

### State 1: All Permissions Granted âœ…
```kotlin
permissionsGranted = true
showPermissionDialog = false
â†’ Show Main Screen
```

### State 2: Permissions Not Granted âŒ
```kotlin
permissionsGranted = false
showPermissionDialog = false
â†’ Show Permission Screen
```

### State 3: Permissions Denied After Request âš ï¸
```kotlin
permissionsGranted = false
showPermissionDialog = true
â†’ Show Warning Dialog + Permission Screen
```

## Code Flow

```kotlin
LaunchedEffect(Unit) {
    // 1. Define required permissions
    val requiredPermissions = mutableListOf(
        Manifest.permission.INTERNET,
        Manifest.permission.ACCESS_NETWORK_STATE
    )
    
    // 2. Add Android 13+ permission
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
        requiredPermissions.add(Manifest.permission.POST_NOTIFICATIONS)
    }
    
    // 3. Check if all granted
    val allGranted = requiredPermissions.all { permission ->
        ContextCompat.checkSelfPermission(context, permission) 
            == PackageManager.PERMISSION_GRANTED
    }
    
    // 4. Update state
    if (allGranted) {
        permissionsGranted = true
    } else {
        permissionLauncher.launch(requiredPermissions.toTypedArray())
    }
}
```

## Permission Launcher

```kotlin
val permissionLauncher = rememberLauncherForActivityResult(
    contract = ActivityResultContracts.RequestMultiplePermissions()
) { permissions ->
    // Check if all permissions granted
    permissionsGranted = permissions.values.all { it }
    
    // Show dialog if any denied
    if (!permissionsGranted) {
        showPermissionDialog = true
    }
}
```

## Android Manifest

```xml
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
<uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
```

## Permission Rationale

### Internet Permission
- **Why**: Required for TCP/IP communication with Windows PC
- **Usage**: Sending commands, receiving responses
- **Critical**: Yes - app cannot function without it

### Network State Permission
- **Why**: Check if device is connected to network
- **Usage**: Validate connection before attempting communication
- **Critical**: Yes - prevents unnecessary connection attempts

### Post Notifications Permission (Android 13+)
- **Why**: Show important alerts and status updates
- **Usage**: Connection status, command results, errors
- **Critical**: No - app works without it, but UX is degraded

## User Experience Considerations

### âœ… Good Practices Implemented:
1. **Clear Explanation**: Each permission has a description
2. **Visual Hierarchy**: Icons and cards make it easy to scan
3. **Single Request**: All permissions requested at once
4. **Graceful Degradation**: App shows permission screen if denied
5. **Retry Option**: User can try again from permission screen
6. **No Blocking**: User sees what's needed before granting

### ðŸŽ¨ Visual Design:
- Lock icon indicates security/permissions
- Check marks show what will be granted
- Card layout groups related information
- Primary button for main action
- Material 3 design system

### ðŸ“± Platform Compatibility:
- Android 6.0+ (API 23+): Runtime permissions
- Android 13+ (API 33+): POST_NOTIFICATIONS
- Backward compatible with older versions

---

**Security Note**: All permissions are used only for their stated purpose and follow Android's best practices for permission handling.
